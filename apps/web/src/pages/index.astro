---
import BaseLayout from '../layouts/BaseLayout.astro';
import { getLangFromUrl, useTranslations, getLocalizedPath } from '../i18n';
import { getCollection } from 'astro:content';

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);

// Get featured content
const allProjects = await getCollection('en/projects');
const featuredProjects = allProjects
  .filter(project => project.data.featured)
  .sort((a, b) => (a.data.order || 999) - (b.data.order || 999))
  .slice(0, 2);

const allPosts = await getCollection('en/blog');
const recentPosts = allPosts
  .sort((a, b) => new Date(b.data.date || '').getTime() - new Date(a.data.date || '').getTime())
  .slice(0, 3);
---

<BaseLayout title={t.nav.home}>
  <!-- Hero Section -->
  <section class="relative bg-gradient-to-b from-gray-50 to-white dark:from-monokai-bg dark:to-monokai-surface py-20 lg:py-32">
    <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="text-center">
        <h1 class="text-4xl md:text-6xl font-bold tracking-tight text-gray-900 dark:text-monokai-text mb-6">
          {t.home.title}
        </h1>
        
        <h2 class="text-xl md:text-2xl text-gray-600 dark:text-monokai-muted mb-8 font-medium">
          {t.home.subtitle}
        </h2>
        
        <p class="text-lg text-gray-600 dark:text-monokai-muted max-w-3xl mx-auto mb-12 leading-relaxed">
          {t.home.description}
        </p>

        <!-- Quick Actions -->
        <div class="flex flex-col sm:flex-row gap-4 justify-center items-center mb-16">
          <a href={getLocalizedPath('/projects/', lang)} 
             class="inline-flex items-center px-6 py-3 bg-gray-900 dark:bg-monokai-text text-white dark:text-monokai-bg rounded-lg font-medium hover:bg-gray-800 dark:hover:bg-gray-300 transition-colors duration-200">
            {t.home.cta.viewProjects}
            <svg class="ml-2 w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
            </svg>
          </a>
          
          <a href={getLocalizedPath('/blog/', lang)} 
             class="inline-flex items-center px-6 py-3 border border-gray-300 dark:border-monokai-border text-gray-700 dark:text-monokai-muted rounded-lg font-medium hover:bg-gray-50 dark:hover:bg-monokai-border/20 transition-colors duration-200">
            {t.home.cta.readBlog}
            <svg class="ml-2 w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
            </svg>
          </a>
        </div>
      </div>
    </div>
  </section>

  <!-- Featured Projects -->
  <section class="py-20 bg-white dark:bg-monokai-surface">
    <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="text-center mb-16">
        <h2 class="text-3xl font-bold text-gray-900 dark:text-monokai-text mb-4">
          Featured Projects
        </h2>
        <p class="text-lg text-gray-600 dark:text-monokai-muted max-w-2xl mx-auto">
          Open source tools and frameworks I've built to solve real-world problems
        </p>
      </div>

      <div class="grid md:grid-cols-2 gap-8 mb-12">
        {featuredProjects.map((project) => (
          <div class="group bg-white dark:bg-monokai-bg border border-gray-200 dark:border-monokai-border rounded-lg p-6 hover:shadow-lg dark:hover:shadow-none dark:hover:border-monokai-muted/30 transition-all duration-200">
            <div class="flex items-start justify-between mb-4">
              <h3 class="text-xl font-semibold text-gray-900 dark:text-monokai-text group-hover:text-blue-600 dark:group-hover:text-blue-400">
                {project.data.title}
              </h3>
              {project.data.github && (
                <a href={project.data.github} 
                   target="_blank" 
                   rel="noopener noreferrer"
                   class="text-gray-400 hover:text-gray-600 dark:hover:text-monokai-muted">
                  <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                  </svg>
                </a>
              )}
            </div>
            
            <p class="text-gray-600 dark:text-monokai-muted mb-4 leading-relaxed">
              {project.data.description}
            </p>
            
            <div class="flex flex-wrap gap-2 mb-4">
              {project.data.tags?.slice(0, 3).map((tag: string) => (
                <span class="inline-block px-3 py-1 text-xs font-medium bg-gray-100 dark:bg-monokai-border/30 text-gray-700 dark:text-monokai-muted rounded-full">
                  {tag}
                </span>
              ))}
            </div>
            
            <a href={getLocalizedPath(`/projects/${project.slug}/`, lang)}
               class="inline-flex items-center text-blue-600 dark:text-blue-400 font-medium hover:text-blue-800 dark:hover:text-blue-300">
              Learn more
              <svg class="ml-1 w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
              </svg>
            </a>
          </div>
        ))}
      </div>

      <div class="text-center">
        <a href={getLocalizedPath('/projects/', lang)} 
           class="inline-flex items-center text-gray-600 dark:text-monokai-muted hover:text-gray-900 dark:hover:text-monokai-text font-medium">
          View all projects
          <svg class="ml-2 w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
          </svg>
        </a>
      </div>
    </div>
  </section>

  <!-- Recent Blog Posts -->
  <section class="py-20 bg-gray-50 dark:bg-monokai-bg">
    <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="text-center mb-16">
        <h2 class="text-3xl font-bold text-gray-900 dark:text-monokai-text mb-4">
          Recent Writing
        </h2>
        <p class="text-lg text-gray-600 dark:text-monokai-muted max-w-2xl mx-auto">
          Thoughts on software engineering, architecture, and building better systems
        </p>
      </div>

      <div class="grid md:grid-cols-3 gap-8 mb-12">
        {recentPosts.map((post) => (
          <article class="bg-white dark:bg-monokai-surface border border-gray-200 dark:border-monokai-border rounded-lg p-6 hover:shadow-lg dark:hover:shadow-none dark:hover:border-monokai-muted/30 transition-all duration-200">
            <div class="mb-4">
              {post.data.series && (
                <span class="inline-block px-2 py-1 text-xs font-medium bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-300 rounded mb-2">
                  Series
                </span>
              )}
              <h3 class="text-lg font-semibold text-gray-900 dark:text-monokai-text mb-2 leading-tight">
                {post.data.title}
              </h3>
              
              {post.data.date && (
                <time class="text-sm text-gray-500 dark:text-monokai-muted">
                  {new Date(post.data.date).toLocaleDateString('en-US', { 
                    year: 'numeric', 
                    month: 'long', 
                    day: 'numeric' 
                  })}
                </time>
              )}
            </div>
            
            <p class="text-gray-600 dark:text-monokai-muted mb-4 leading-relaxed text-sm">
              {post.data.description}
            </p>
            
            <a href={getLocalizedPath(`/blog/${post.slug}/`, lang)}
               class="inline-flex items-center text-blue-600 dark:text-blue-400 font-medium hover:text-blue-800 dark:hover:text-blue-300 text-sm">
              Read more
              <svg class="ml-1 w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
              </svg>
            </a>
          </article>
        ))}
      </div>

      <div class="text-center">
        <a href={getLocalizedPath('/blog/', lang)} 
           class="inline-flex items-center text-gray-600 dark:text-monokai-muted hover:text-gray-900 dark:hover:text-monokai-text font-medium">
          View all posts
          <svg class="ml-2 w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
          </svg>
        </a>
      </div>
    </div>
  </section>

  <!-- Contact/Connect Section -->
  <section class="py-20 bg-white dark:bg-monokai-surface">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
      <h2 class="text-3xl font-bold text-gray-900 dark:text-monokai-text mb-4">
        Let's Connect
      </h2>
      <p class="text-lg text-gray-600 dark:text-monokai-muted mb-8">
        Interested in collaborating or discussing software engineering ideas?
      </p>
      
      <div class="flex flex-col sm:flex-row gap-4 justify-center items-center">
        <a href={getLocalizedPath('/cv/', lang)} 
           class="inline-flex items-center px-6 py-3 bg-gray-100 dark:bg-monokai-border/30 text-gray-700 dark:text-monokai-muted rounded-lg font-medium hover:bg-gray-200 dark:hover:bg-monokai-border/50 transition-colors duration-200">
          <svg class="mr-2 w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
          </svg>
          View CV
        </a>
        
        <a href="https://github.com/rodrigopsasaki" 
           target="_blank" 
           rel="noopener noreferrer"
           class="inline-flex items-center px-6 py-3 bg-gray-100 dark:bg-monokai-border/30 text-gray-700 dark:text-monokai-muted rounded-lg font-medium hover:bg-gray-200 dark:hover:bg-monokai-border/50 transition-colors duration-200">
          <svg class="mr-2 w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
            <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
          </svg>
          GitHub
        </a>
      </div>
    </div>
  </section>
</BaseLayout>
